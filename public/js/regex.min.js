"use strict";var inputs=[],matches=[];function comparison(){regex=document.querySelector("#regex"),read_cases(),regex.oninput=function(){check_rows()},inputs.forEach(function(e){e.oninput=function(){handler(e)}})}function check_rows(){convert_to_regex()?inputs.forEach(function(e){handler(e)}):matches.forEach(function(e){remove_match(e)})}function handler(e){var t=e.nextElementSibling,n=convert_to_regex();n instanceof RegExp&&(n.test(e.value)?add_match(t):remove_match(t))}function add_match(e){e.classList.remove("increase"),e.classList.add("decrease"),e.addEventListener("webkitAnimationEnd",function(){console.log(e),e.classList.remove("no-match"),e.classList.remove("decrease"),e.classList.add("match"),e.innerHTML="&#xf00c",e.classList.add("increase")})}function read_cases(){var e=document.querySelectorAll(".my-case-block");inputs.length=0,matches.length=0;for(var t=0;t<e.length;t++)inputs[t]=e[t].children[0],matches[t]=e[t].children[1]}function convert_to_regex(){var e=/^\/.*\/(?:([igmy])(?!\1)){0,4}$/,t=regex.value;if(e.test(t)){e=/\/(.*)\/(.*)$/;var n=t.match(e);return e=new RegExp("^"+n[1]+"$",n[2])}return!1}function remove_match(e){e.classList.remove("increase"),e.classList.add("decrease"),e.addEventListener("webkitAnimationEnd",function(){console.log(e),e.classList.remove("match"),e.classList.remove("decrease"),e.classList.add("no-match"),e.innerHTML="&#xf00d",e.classList.add("increase")})}function add_field(){var e=document.createElement("div");return e.className="my-case-block",e.innerHTML='<input type="text" class="case-text"/> <div class="answer no-match">&#xf00d</div><input type="button" value="&#xf068" id="remove" onclick="return remove_field(this)">',document.getElementById("block-cases").appendChild(e),read_cases(),inputs[inputs.length-1].oninput=function(){handler(inputs[inputs.length-1])},handler(inputs[inputs.length-1]),e.classList.add("add-case-block"),!1}function remove_field(e){var t=e.parentNode,n=t.nextElementSibling,a=n;for(t.classList.remove("add-case-block"),t.classList.add("remove-case-block"),t.addEventListener("webkitAnimationEnd",function(){t.parentNode.removeChild(t),read_cases()});null!=n;)n.classList.add("move-up-case"),n=n.nextElementSibling;return setTimeout(deleteMoveUpAnimation,1e3,a),!1}function deleteMoveUpAnimation(e){for(var t=e;null!=t;)console.log(t),t.classList.remove("move-up-case"),t.classList.remove("add-case-block"),t=t.nextElementSibling}function fillCompareExample(e){console.log(e),regex.value=e.regex;for(var t=0;t<e.values.length;t++)inputs[t].value=e.values[t];check_rows()}var regex,replacement,text_before=[],text_after=[],text_expected=[];matches=[];function replace(){regex=document.querySelector("#regex"),replacement=document.querySelector("#replacement"),read_cases_replacement(),regex.oninput=function(){getResultOfReplacementForAll()},replacement.oninput=function(){getResultOfReplacementForAll()},addEvents()}function addEvents(){for(var e=0;e<text_before.length;e++)text_before[e].oninput=function(){getResultOfReplacement(this),determineMatch(this.nextElementSibling.nextElementSibling)},text_expected[e].oninput=function(){determineMatch(this)}}function getResultOfReplacementForAll(){for(var e=0;e<text_before.length;e++)getResultOfReplacement(text_before[e]),determineMatch(text_expected[e])}function getResultOfReplacement(e){var t=e.nextElementSibling,n=convert_to_regex_replacement(regex.value);if(n){console.log(!0);var a=replacement.value,s=e.value;t.value=s.replace(n,a)}}function determineMatch(e){var t=e.nextElementSibling,n=e.previousElementSibling;e.value==n.value?add_match(t):remove_match(t)}function remove_match(e){e.classList.remove("increase"),e.classList.add("decrease"),e.addEventListener("webkitAnimationEnd",function(){console.log(e),e.classList.remove("match"),e.classList.remove("decrease"),e.classList.add("no-match"),e.innerHTML="&#xf00d",e.classList.add("increase")})}function add_match(e){e.classList.remove("increase"),e.classList.add("decrease"),e.addEventListener("webkitAnimationEnd",function(){console.log(e),e.classList.remove("no-match"),e.classList.remove("decrease"),e.classList.add("match"),e.innerHTML="&#xf00c",e.classList.add("increase")})}function convert_to_regex_replacement(){var e=/^\/.*\/(?:([igmy])(?!\1)){0,4}$/,t=regex.value;if(e.test(t)){e=/\/(.*)\/(.*)$/;var n=t.match(e);return e=new RegExp(n[1],n[2])}return!1}function read_cases_replacement(){var e=document.querySelectorAll(".my-case-block");text_before.length=0,text_after.length=0,text_expected.length=0,matches.length=0;for(var t=0;t<e.length;t++)text_before[t]=e[t].children[0],text_after[t]=e[t].children[1],text_expected[t]=e[t].children[2],matches[t]=e[t].children[3]}function add_replacement_field(){var e=document.createElement("div");return e.className="my-case-block",e.innerHTML='<textarea class="text_before" placeholder="original text"></textarea><textarea class="text_after" placeholder="result of replacement" disabled></textarea><textarea class="text_expected" placeholder="expected result"></textarea><div class="answer no-match increase">&#xf00d</div> <input type="button" value="&#xf068" id="remove" onclick="return remove_replacement_field(this)">',document.getElementById("block-cases").appendChild(e),read_cases_replacement(),addEvents(),e.classList.add("add-case-block"),!1}function remove_replacement_field(e){var t=e.parentNode,n=t.nextElementSibling,a=n;for(t.classList.remove("add-case-block"),t.classList.add("remove-case-block"),t.addEventListener("webkitAnimationEnd",function(){t.parentNode.removeChild(t),read_cases_replacement(),addEvents()});null!=n;)n.classList.add("move-up-case"),n=n.nextElementSibling;return setTimeout(deleteMoveUpAnimation,1e3,a),!1}function deleteMoveUpAnimation(e){for(var t=e;null!=t;)console.log(t),t.classList.remove("move-up-case"),t.classList.remove("add-case-block"),t=t.nextElementSibling}function fillReplaceExample(e){regex.value=e.regex,replacement.value=e.replace;for(var t=0;t<e.values.length;t++)text_before[t].value=e.values[t].value,text_expected[t].value=e.values[t].answer;read_cases_replacement(),getResultOfReplacementForAll(),console.log(e)}document.addEventListener("DOMContentLoaded",function(){getPage("menu"),getPage("compare")}),window.onpopstate=function(){getPage(document.location.hash.replace("#",""))};function getPage(e,t){var n=new XMLHttpRequest;n.open("GET","/"+e+".html",!0),n.setRequestHeader("X-Requested-With","XMLHttpRequest"),n.send(),n.onreadystatechange=function(){4==n.readyState&&(200!=n.status?alert(n.status+": "+n.statusText):"menu"==e?document.querySelector(".menu").innerHTML=n.responseText:(document.querySelector(".flex-container").innerHTML=n.responseText,"compare"==e?comparison():"replace"==e&&replace(),null!=t&&getTasks(t)))}}function getTasks(e){var t=new XMLHttpRequest;t.open("GET","../tasks/"+e+"Tasks.json",!0),t.setRequestHeader("X-Requested-With","XMLHttpRequest"),t.send(),t.onreadystatechange=function(){if(4==t.readyState)if(200!=t.status)alert(t.status+": "+t.statusText);else{var n=JSON.parse(t.responseText);"compare1"==e||"compare2"==e?fillCompareExample(n):"replace1"!=e&&"replace2"!=e||fillReplaceExample(n)}}}
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNjcmlwdF9jb21wYXJpc29uLmpzIiwic2NyaXB0X3JlcGxhY2VtZW50LmpzIiwic2NyaXB0X21haW4uanMiXSwibmFtZXMiOlsiaW5wdXRzIiwibWF0Y2hlcyIsImNvbXBhcmlzb24iLCJyZWdleCIsImRvY3VtZW50IiwicXVlcnlTZWxlY3RvciIsInJlYWRfY2FzZXMiLCJvbmlucHV0IiwiY2hlY2tfcm93cyIsImZvckVhY2giLCJpdGVtIiwiaGFuZGxlciIsImNvbnZlcnRfdG9fcmVnZXgiLCJpbnB1dCIsIm1hdGNoIiwicmVtb3ZlX21hdGNoIiwiZGl2IiwibmV4dEVsZW1lbnRTaWJsaW5nIiwidG1wIiwiUmVnRXhwIiwidGVzdCIsInZhbHVlIiwiYWRkX21hdGNoIiwiY2xhc3NMaXN0IiwicmVtb3ZlIiwiYWRkIiwiYWRkRXZlbnRMaXN0ZW5lciIsImNvbnNvbGUiLCJsb2ciLCJpbm5lckhUTUwiLCJjYXNlcyIsInF1ZXJ5U2VsZWN0b3JBbGwiLCJsZW5ndGgiLCJpIiwiY2hpbGRyZW4iLCJyZWdleF90ZW1wbCIsImZvdW5kIiwiYWRkX2ZpZWxkIiwiY3JlYXRlRWxlbWVudCIsImNsYXNzTmFtZSIsImdldEVsZW1lbnRCeUlkIiwiYXBwZW5kQ2hpbGQiLCJyZW1vdmVfZmllbGQiLCJmaWVsZCIsImNvbnREaXYiLCJwYXJlbnROb2RlIiwibmV4dCIsImZpcnN0IiwicmVtb3ZlQ2hpbGQiLCJzZXRUaW1lb3V0IiwiZGVsZXRlTW92ZVVwQW5pbWF0aW9uIiwiZmlsbENvbXBhcmVFeGFtcGxlIiwidmFsdWVzIiwicmVwbGFjZW1lbnQiLCJ0ZXh0X2JlZm9yZSIsInRleHRfYWZ0ZXIiLCJ0ZXh0X2V4cGVjdGVkIiwicmVwbGFjZSIsInJlYWRfY2FzZXNfcmVwbGFjZW1lbnQiLCJnZXRSZXN1bHRPZlJlcGxhY2VtZW50Rm9yQWxsIiwiYWRkRXZlbnRzIiwiZ2V0UmVzdWx0T2ZSZXBsYWNlbWVudCIsInRoaXMiLCJkZXRlcm1pbmVNYXRjaCIsInJlc3VsdCIsInJlZ2V4X3ZhbHVlIiwiY29udmVydF90b19yZWdleF9yZXBsYWNlbWVudCIsInJlcGxhY2VtZW50X3ZhbHVlIiwiaW5wdXRfdmFsdWUiLCJleHBlY3RlZCIsInByZXZpb3VzRWxlbWVudFNpYmxpbmciLCJhZGRfcmVwbGFjZW1lbnRfZmllbGQiLCJyZW1vdmVfcmVwbGFjZW1lbnRfZmllbGQiLCJmaWxsUmVwbGFjZUV4YW1wbGUiLCJhbnN3ZXIiLCJnZXRQYWdlIiwid2luZG93Iiwib25wb3BzdGF0ZSIsImxvY2F0aW9uIiwiaGFzaCIsInBhZ2UiLCJleGFtcGxlIiwieGhyIiwiWE1MSHR0cFJlcXVlc3QiLCJvcGVuIiwic2V0UmVxdWVzdEhlYWRlciIsInNlbmQiLCJvbnJlYWR5c3RhdGVjaGFuZ2UiLCJyZWFkeVN0YXRlIiwic3RhdHVzIiwiYWxlcnQiLCJzdGF0dXNUZXh0IiwicmVzcG9uc2VUZXh0IiwiZ2V0VGFza3MiLCJvYmoiLCJKU09OIiwicGFyc2UiXSwibWFwcGluZ3MiOiJhQUFBLElBQ0FBLFVBQUFDLFdBQ0EsU0FBQUMsYUFDQUMsTUFBQUMsU0FBQUMsY0FBQSxVQUNBQyxhQUVBSCxNQUFBSSxRQUFBLFdBQ0FDLGNBR0FSLE9BQUFTLFFBQUEsU0FBQUMsR0FDQUEsRUFBQUgsUUFBQSxXQUFBSSxRQUFBRCxNQUlBLFNBQUFGLGFBQ0FJLG1CQUNBWixPQUFBUyxRQUFBLFNBQUFJLEdBQ0FGLFFBQUFFLEtBR0FaLFFBQUFRLFFBQUEsU0FBQUssR0FDQUMsYUFBQUQsS0FLQSxTQUFBSCxRQUFBRSxHQUNBLElBQUFHLEVBQUFILEVBQUFJLG1CQUNBQyxFQUFBTixtQkFDQU0sYUFBQUMsU0FDQUQsRUFBQUUsS0FBQVAsRUFBQVEsT0FDQUMsVUFBQU4sR0FFQUQsYUFBQUMsSUFLQSxTQUFBTSxVQUFBTixHQUNBQSxFQUFBTyxVQUFBQyxPQUFBLFlBQ0FSLEVBQUFPLFVBQUFFLElBQUEsWUFDQVQsRUFBQVUsaUJBQUEscUJBQUEsV0FDQUMsUUFBQUMsSUFBQVosR0FDQUEsRUFBQU8sVUFBQUMs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d0IsR0FDQVksU0FBQVosTUFRQSxTQUFBWSxTQUFBYixHQUNBLElBQUFFLEVBQUEsSUFBQUMsZUFDQUQsRUFBQUUsS0FBQSxNQUFBLFlBQUFKLEVBQUEsY0FBQSxHQUNBRSxFQUFBRyxpQkFBQSxtQkFBQSxrQkFDQUgsRUFBQUksT0FFQUosRUFBQUssbUJBQUEsV0FDQSxHQUFBLEdBQUFMLEVBQUFNLFdBQ0EsR0FBQSxLQUFBTixFQUFBTyxPQUNBQyxNQUFBUixFQUFBTyxPQUFBLEtBQUFQLEVBQUFTLGdCQUNBLENBQ0EsSUFBQUcsRUFBQUMsS0FBQUMsTUFBQWQsRUFBQVUsY0FDQSxZQUFBWixHQUFBLFlBQUFBLEVBQ0E3QixtQkFBQTJDLEdBQ0EsWUFBQWQsR0FBQSxZQUFBQSxHQUNBUCxtQkFBQXFCIiwiZmlsZSI6InJlZ2V4Lm1pbi5qcyIsInNvdXJjZXNDb250ZW50IjpbInZhciByZWdleDtcclxudmFyIGlucHV0cyA9IFtdLCBtYXRjaGVzID0gW107XHJcbmZ1bmN0aW9uIGNvbXBhcmlzb24oKXtcclxuICAgIHJlZ2V4ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNyZWdleFwiKTtcclxuICAgIHJlYWRfY2FzZXMoKTtcclxuXHJcbiAgICByZWdleC5vbmlucHV0ID0gZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgY2hlY2tfcm93cygpO1xyXG4gICAgfTtcclxuXHJcbiAgICBpbnB1dHMuZm9yRWFjaChmdW5jdGlvbihpdGVtKSB7XHJcbiAgICAgICAgaXRlbS5vbmlucHV0ID0gZnVuY3Rpb24oKSB7IGhhbmRsZXIoaXRlbSkgfTtcclxuICAgIH0pO1xyXG59XHJcblxyXG5mdW5jdGlvbiBjaGVja19yb3dzKCkge1xyXG4gICAgaWYgKGNvbnZlcnRfdG9fcmVnZXgoKSkge1xyXG4gICAgICBpbnB1dHMuZm9yRWFjaChmdW5jdGlvbihpbnB1dCkge1xyXG4gICAgICAgIGhhbmRsZXIoaW5wdXQpO1xyXG4gICAgICB9KTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIG1hdGNoZXMuZm9yRWFjaChmdW5jdGlvbihtYXRjaCkge1xyXG4gICAgICAgIHJlbW92ZV9tYXRjaChtYXRjaCk7XHJcbiAgICAgIH0pO1xyXG4gICAgfVxyXG59XHJcblxyXG5mdW5jdGlvbiBoYW5kbGVyKGlucHV0KSB7XHJcbiAgICB2YXIgZGl2ID0gaW5wdXQubmV4dEVsZW1lbnRTaWJsaW5nO1xyXG4gICAgdmFyIHRtcCA9IGNvbnZlcnRfdG9fcmVnZXgoKTtcclxuICAgIGlmICh0bXAgaW5zdGFuY2VvZiBSZWdFeHApIHtcclxuICAgICAgaWYgKHRtcC50ZXN0KGlucHV0LnZhbHVlKSkge1xyXG4gICAgICAgIGFkZF9tYXRjaChkaXYpO1xyXG4gICAgICB9IGVsc2Uge1xyXG4gICAgICAgIHJlbW92ZV9tYXRjaChkaXYpO1xyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuZnVuY3Rpb24gYWRkX21hdGNoKGRpdil7XHJcbiAgICBkaXYuY2xhc3NMaXN0LnJlbW92ZShcImluY3JlYXNlXCIpO1xyXG4gICAgZGl2LmNsYXNzTGlzdC5hZGQoXCJkZWNyZWFzZVwiKTtcclxuICAgIGRpdi5hZGRFdmVudExpc3RlbmVyKFwid2Via2l0QW5pbWF0aW9uRW5kXCIsIGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIGNvbnNvbGUubG9nKGRpdik7XHJcbiAgICAgICAgZGl2LmNsYXNzTGlzdC5yZW1vdmUoXCJuby1tYXRjaFwiKTtcclxuICAgICAgICBkaXYuY2xhc3NMaXN0LnJlbW92ZShcImRlY3JlYXNlXCIpO1xyXG4gICAgICAgIGRpdi5jbGFzc0xpc3QuYWRkKFwibWF0Y2hcIik7IFxyXG4gICAgICAgIGRpdi5pbm5lckhUTUwgPSBcIiYjeGYwMGNcIjtcclxuICAgICAgICBkaXYuY2xhc3NMaXN0LmFkZChcImluY3JlYXNlXCIpO1xyXG4gICAgfSlcclxufVxyXG5cclxuZnVuY3Rpb24gcmVhZF9jYXNlcygpIHtcclxuICAgIHZhciBjYXNlcyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoXCIubXktY2FzZS1ibG9ja1wiKVxyXG4gICAgaW5wdXRzLmxlbmd0aCA9IDA7XHJcbiAgICBtYXRjaGVzLmxlbmd0aCA9IDA7XHJcbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IGNhc2VzLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgaW5wdXRzW2ldID0gY2FzZXNbaV0uY2hpbGRyZW5bMF07XHJcbiAgICAgICAgbWF0Y2hlc1tpXSA9IGNhc2VzW2ldLmNoaWxkcmVuWzFdO1xyXG4gICAgfVxyXG59XHJcblxyXG5mdW5jdGlvbiBjb252ZXJ0X3RvX3JlZ2V4KCkge1xyXG4gICAgdmFyIHJlZ2V4X3RlbXBsID0gL15cXC8uKlxcLyg/OihbaWdteV0pKD8hXFwxKSl7MCw0fSQvO1xyXG4gICAgdmFyIHZhbHVlID0gcmVnZXgudmFsdWU7XHJcbiAgICBpZiAocmVnZXhfdGVtcGwudGVzdCh2YWx1ZSkpIHtcclxuICAgICAgICByZWdleF90ZW1wbCA9IC9cXC8oLiopXFwvKC4qKSQvO1xyXG4gICAgICAgIHZhciBmb3VuZCA9IHZhbHVlLm1hdGNoKHJlZ2V4X3RlbXBsKTtcclxuICAgICAgICByZWdleF90ZW1wbCA9IG5ldyBSZWdFeHAoXCJeXCIgKyBmb3VuZFsxXSArIFwiJFwiLCBmb3VuZFsyXSk7XHJcbiAgICAgICAgcmV0dXJuIHJlZ2V4X3RlbXBsO1xyXG4gICAgfSBcclxuICAgIGVsc2Uge1xyXG4gICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIGZ1bmN0aW9uIHJlbW92ZV9tYXRjaChkaXYpIHtcclxuICAgIGRpdi5jbGFzc0xpc3QucmVtb3ZlKFwiaW5jcmVhc2VcIik7XHJcbiAgICBkaXYuY2xhc3NMaXN0LmFkZChcImRlY3JlYXNlXCIpO1xyXG4gICAgZGl2LmFkZEV2ZW50TGlzdGVuZXIoXCJ3ZWJraXRBbmltYXRpb25FbmRcIiwgZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgY29uc29sZS5sb2coZGl2KTtcclxuICAgICAgICBkaXYuY2xhc3NMaXN0LnJlbW92ZShcIm1hdGNoXCIpO1xyXG4gICAgICAgIGRpdi5jbGFzc0xpc3QucmVtb3ZlKFwiZGVjcmVhc2VcIik7XHJcbiAgICAgICAgZGl2LmNsYXNzTGlzdC5hZGQoXCJuby1tYXRjaFwiKTsgXHJcbiAgICAgICAgZGl2LmlubmVySFRNTCA9IFwiJiN4ZjAwZFwiO1xyXG4gICAgICAgIGRpdi5jbGFzc0xpc3QuYWRkKFwiaW5jcmVhc2VcIik7XHJcbiAgICB9KVxyXG59XHJcblxyXG4gIGZ1bmN0aW9uIGFkZF9maWVsZCgpe1xyXG4gICAgdmFyIGRpdiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIik7XHJcbiAgICBkaXYuY2xhc3NOYW1lID0gXCJteS1jYXNlLWJsb2NrXCI7XHJcbiAgICBkaXYuaW5uZXJIVE1MID0gXCI8aW5wdXQgdHlwZT1cXFwidGV4dFxcXCIgY2xhc3M9XFxcImNhc2UtdGV4dFxcXCIvPiA8ZGl2IGNsYXNzPVxcXCJhbnN3ZXIgbm8tbWF0Y2hcXFwiPiYjeGYwMGQ8L2Rpdj48aW5wdXQgdHlwZT1cXFwiYnV0dG9uXFxcIiB2YWx1ZT1cXFwiJiN4ZjA2OFxcXCIgaWQ9XFxcInJlbW92ZVxcXCIgb25jbGljaz1cXFwicmV0dXJuIHJlbW92ZV9maWVsZCh0aGlzKVxcXCI+XCI7XHJcbiAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcImJsb2NrLWNhc2VzXCIpLmFwcGVuZENoaWxkKGRpdik7XHJcbiAgICByZWFkX2Nhc2VzKCk7XHJcbiAgICBpbnB1dHNbaW5wdXRzLmxlbmd0aC0xXS5vbmlucHV0ID0gZnVuY3Rpb24oKSB7IGhhbmRsZXIoaW5wdXRzW2lucHV0cy5sZW5ndGgtMV0pIH07XHJcbiAgICBoYW5kbGVyKGlucHV0c1tpbnB1dHMubGVuZ3RoLTFdKTtcclxuICAgIGRpdi5jbGFzc0xpc3QuYWRkKFwiYWRkLWNhc2UtYmxvY2tcIik7XHJcbiAgICByZXR1cm4gZmFsc2U7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIHJlbW92ZV9maWVsZChmaWVsZCl7XHJcbiAgICB2YXIgY29udERpdiA9IGZpZWxkLnBhcmVudE5vZGU7XHJcbiAgICB2YXIgbmV4dCA9IGNvbnREaXYubmV4dEVsZW1lbnRTaWJsaW5nO1xyXG4gICAgdmFyIGZpcnN0ID0gbmV4dDtcclxuXHJcbiAgICBjb250RGl2LmNsYXNzTGlzdC5yZW1vdmUoXCJhZGQtY2FzZS1ibG9ja1wiKTtcclxuICAgIGNvbnREaXYuY2xhc3NMaXN0LmFkZChcInJlbW92ZS1jYXNlLWJsb2NrXCIpO1xyXG4gICAgY29udERpdi5hZGRFdmVudExpc3RlbmVyKFwid2Via2l0QW5pbWF0aW9uRW5kXCIsIGZ1bmN0aW9uKCkgeyAgICBcclxuICAgICAgICAgICAgY29udERpdi5wYXJlbnROb2RlLnJlbW92ZUNoaWxkKGNvbnREaXYpOyBcclxuICAgICAgICAgICAgcmVhZF9jYXNlcygpO1xyXG4gICAgICAgIH1cclxuICAgICk7IFxyXG5cclxuICAgIHdoaWxlKG5leHQgIT0gbnVsbCl7ICAgIFxyXG4gICAgICAgIG5leHQuY2xhc3NMaXN0LmFkZChcIm1vdmUtdXAtY2FzZVwiKTtcclxuICAgICAgICBuZXh0ID0gbmV4dC5uZXh0RWxlbWVudFNpYmxpbmc7XHJcbiAgICB9XHJcblxyXG4gICAgc2V0VGltZW91dChkZWxldGVNb3ZlVXBBbmltYXRpb24sIDEwMDAsIGZpcnN0KTtcclxuXHJcbiAgICByZXR1cm4gZmFsc2U7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIGRlbGV0ZU1vdmVVcEFuaW1hdGlvbihmaXJzdCl7XHJcbiAgICB2YXIgbmV4dCA9IGZpcnN0O1xyXG4gICAgd2hpbGUobmV4dCAhPSBudWxsKXtcclxuICAgICAgICBjb25zb2xlLmxvZyhuZXh0KTtcclxuICAgICAgICBuZXh0LmNsYXNzTGlzdC5yZW1vdmUoXCJtb3ZlLXVwLWNhc2VcIik7IFxyXG4gICAgICAgIG5leHQuY2xhc3NMaXN0LnJlbW92ZShcImFkZC1jYXNlLWJsb2NrXCIpO1xyXG4gICAgICAgIG5leHQgPSBuZXh0Lm5leHRFbGVtZW50U2libGluZztcclxuICAgIH0gXHJcbn1cclxuXHJcbmZ1bmN0aW9uIGZpbGxDb21wYXJlRXhhbXBsZShpbnB1dCkge1xyXG4gICAgY29uc29sZS5sb2coaW5wdXQpO1xyXG4gICAgcmVnZXgudmFsdWUgPSBpbnB1dC5yZWdleDtcclxuICAgZm9yKHZhciBpID0gMDsgaSA8IGlucHV0LnZhbHVlcy5sZW5ndGg7IGkrKyl7XHJcbiAgICBpbnB1dHNbaV0udmFsdWUgPSBpbnB1dC52YWx1ZXNbaV07XHJcbiAgIH1cclxuICAgY2hlY2tfcm93cygpO1xyXG59IiwidmFyIHJlZ2V4O1xyXG52YXIgcmVwbGFjZW1lbnQ7XHJcbnZhciB0ZXh0X2JlZm9yZSA9IFtdLCB0ZXh0X2FmdGVyID0gW10sIHRleHRfZXhwZWN0ZWQgPSBbXSwgbWF0Y2hlcyA9IFtdO1xyXG5cclxuZnVuY3Rpb24gcmVwbGFjZSgpeyAgIFxyXG4gICAgcmVnZXggPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI3JlZ2V4XCIpO1xyXG4gICAgcmVwbGFjZW1lbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI3JlcGxhY2VtZW50XCIpO1xyXG4gICAgcmVhZF9jYXNlc19yZXBsYWNlbWVudCgpO1xyXG5cclxuICAgIHJlZ2V4Lm9uaW5wdXQgPSBmdW5jdGlvbigpeyBnZXRSZXN1bHRPZlJlcGxhY2VtZW50Rm9yQWxsKCkgfTtcclxuICAgIHJlcGxhY2VtZW50Lm9uaW5wdXQgPSBmdW5jdGlvbigpeyBnZXRSZXN1bHRPZlJlcGxhY2VtZW50Rm9yQWxsKCkgfTtcclxuICAgIGFkZEV2ZW50cygpO1xyXG59XHJcblxyXG5mdW5jdGlvbiBhZGRFdmVudHMoKXtcclxuICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGV4dF9iZWZvcmUubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICB0ZXh0X2JlZm9yZVtpXS5vbmlucHV0ID0gZnVuY3Rpb24oKXsgZ2V0UmVzdWx0T2ZSZXBsYWNlbWVudCh0aGlzKTsgZGV0ZXJtaW5lTWF0Y2godGhpcy5uZXh0RWxlbWVudFNpYmxpbmcubmV4dEVsZW1lbnRTaWJsaW5nKX07XHJcbiAgICAgICAgdGV4dF9leHBlY3RlZFtpXS5vbmlucHV0ID0gZnVuY3Rpb24oKXsgZGV0ZXJtaW5lTWF0Y2godGhpcykgfTtcclxuICAgIH1cclxufVxyXG5cclxuZnVuY3Rpb24gZ2V0UmVzdWx0T2ZSZXBsYWNlbWVudEZvckFsbCgpe1xyXG4gICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0ZXh0X2JlZm9yZS5sZW5ndGg7IGkrKykge1xyXG4gICAgICAgIGdldFJlc3VsdE9mUmVwbGFjZW1lbnQodGV4dF9iZWZvcmVbaV0pO1xyXG4gICAgICAgIGRldGVybWluZU1hdGNoKHRleHRfZXhwZWN0ZWRbaV0pO1xyXG4gICAgfVxyXG59XHJcblxyXG5mdW5jdGlvbiBnZXRSZXN1bHRPZlJlcGxhY2VtZW50KGlucHV0KXtcclxuICAgIHZhciByZXN1bHQgPSBpbnB1dC5uZXh0RWxlbWVudFNpYmxpbmc7XHJcbiAgICB2YXIgcmVnZXhfdmFsdWUgPSBjb252ZXJ0X3RvX3JlZ2V4X3JlcGxhY2VtZW50KHJlZ2V4LnZhbHVlKTtcclxuICAgIGlmKHJlZ2V4X3ZhbHVlKXtcclxuICAgICAgICBjb25zb2xlLmxvZyh0cnVlKTtcclxuICAgICAgICB2YXIgcmVwbGFjZW1lbnRfdmFsdWUgPSByZXBsYWNlbWVudC52YWx1ZTtcclxuICAgICAgICB2YXIgaW5wdXRfdmFsdWUgPSBpbnB1dC52YWx1ZTtcclxuXHJcbiAgICAgICAgcmVzdWx0LnZhbHVlID0gaW5wdXRfdmFsdWUucmVwbGFjZShyZWdleF92YWx1ZSwgcmVwbGFjZW1lbnRfdmFsdWUpO1xyXG4gICAgfVxyXG59XHJcblxyXG5mdW5jdGlvbiBkZXRlcm1pbmVNYXRjaChleHBlY3RlZCl7XHJcbiAgICB2YXIgbWF0Y2ggPSBleHBlY3RlZC5uZXh0RWxlbWVudFNpYmxpbmc7XHJcbiAgICB2YXIgcmVzdWx0ID0gZXhwZWN0ZWQucHJldmlvdXNFbGVtZW50U2libGluZztcclxuICAgIGlmKGV4cGVjdGVkLnZhbHVlID09IHJlc3VsdC52YWx1ZSl7XHJcbiAgICAgICAgYWRkX21hdGNoKG1hdGNoKTtcclxuICAgIH1cclxuICAgIGVsc2V7XHJcbiAgICAgICAgcmVtb3ZlX21hdGNoKG1hdGNoKTtcclxuICAgIH1cclxufVxyXG5cclxuZnVuY3Rpb24gcmVtb3ZlX21hdGNoKGRpdikge1xyXG4gICAgZGl2LmNsYXNzTGlzdC5yZW1vdmUoXCJpbmNyZWFzZVwiKTtcclxuICAgIGRpdi5jbGFzc0xpc3QuYWRkKFwiZGVjcmVhc2VcIik7XHJcbiAgICBkaXYuYWRkRXZlbnRMaXN0ZW5lcihcIndlYmtpdEFuaW1hdGlvbkVuZFwiLCBmdW5jdGlvbigpIHtcclxuICAgICAgICBjb25zb2xlLmxvZyhkaXYpO1xyXG4gICAgICAgIGRpdi5jbGFzc0xpc3QucmVtb3ZlKFwibWF0Y2hcIik7XHJcbiAgICAgICAgZGl2LmNsYXNzTGlzdC5yZW1vdmUoXCJkZWNyZWFzZVwiKTtcclxuICAgICAgICBkaXYuY2xhc3NMaXN0LmFkZChcIm5vLW1hdGNoXCIpOyBcclxuICAgICAgICBkaXYuaW5uZXJIVE1MID0gXCImI3hmMDBkXCI7XHJcbiAgICAgICAgZGl2LmNsYXNzTGlzdC5hZGQoXCJpbmNyZWFzZVwiKTtcclxuICAgIH0pXHJcbn1cclxuXHJcbmZ1bmN0aW9uIGFkZF9tYXRjaChkaXYpe1xyXG4gICAgZGl2LmNsYXNzTGlzdC5yZW1vdmUoXCJpbmNyZWFzZVwiKTtcclxuICAgIGRpdi5jbGFzc0xpc3QuYWRkKFwiZGVjcmVhc2VcIik7XHJcbiAgICBkaXYuYWRkRXZlbnRMaXN0ZW5lcihcIndlYmtpdEFuaW1hdGlvbkVuZFwiLCBmdW5jdGlvbigpIHtcclxuICAgICAgICBjb25zb2xlLmxvZyhkaXYpO1xyXG4gICAgICAgIGRpdi5jbGFzc0xpc3QucmVtb3ZlKFwibm8tbWF0Y2hcIik7XHJcbiAgICAgICAgZGl2LmNsYXNzTGlzdC5yZW1vdmUoXCJkZWNyZWFzZVwiKTtcclxuICAgICAgICBkaXYuY2xhc3NMaXN0LmFkZChcIm1hdGNoXCIpOyBcclxuICAgICAgICBkaXYuaW5uZXJIVE1MID0gXCImI3hmMDBjXCI7XHJcbiAgICAgICAgZGl2LmNsYXNzTGlzdC5hZGQoXCJpbmNyZWFzZVwiKTtcclxuICAgIH0pXHJcbn1cclxuXHJcbmZ1bmN0aW9uIGNvbnZlcnRfdG9fcmVnZXhfcmVwbGFjZW1lbnQoKSB7XHJcbiAgICB2YXIgcmVnZXhfdGVtcGwgPSAvXlxcLy4qXFwvKD86KFtpZ215XSkoPyFcXDEpKXswLDR9JC87XHJcbiAgICB2YXIgdmFsdWUgPSByZWdleC52YWx1ZTtcclxuICAgIGlmIChyZWdleF90ZW1wbC50ZXN0KHZhbHVlKSkge1xyXG4gICAgICAgIHJlZ2V4X3RlbXBsID0gL1xcLyguKilcXC8oLiopJC87XHJcbiAgICAgICAgdmFyIGZvdW5kID0gdmFsdWUubWF0Y2gocmVnZXhfdGVtcGwpO1xyXG4gICAgICAgIHJlZ2V4X3RlbXBsID0gbmV3IFJlZ0V4cChmb3VuZFsxXSwgZm91bmRbMl0pO1xyXG4gICAgICAgIHJldHVybiByZWdleF90ZW1wbDtcclxuICAgIH0gXHJcbiAgICBlbHNlIHtcclxuICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICB9XHJcbn1cclxuXHJcbmZ1bmN0aW9uIHJlYWRfY2FzZXNfcmVwbGFjZW1lbnQoKSB7XHJcbiAgICB2YXIgY2FzZXMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKFwiLm15LWNhc2UtYmxvY2tcIilcclxuICAgIHRleHRfYmVmb3JlLmxlbmd0aCA9IDA7XHJcbiAgICB0ZXh0X2FmdGVyLmxlbmd0aCA9IDA7XHJcbiAgICB0ZXh0X2V4cGVjdGVkLmxlbmd0aCA9IDA7XHJcbiAgICBtYXRjaGVzLmxlbmd0aCA9IDA7XHJcbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IGNhc2VzLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgdGV4dF9iZWZvcmVbaV0gPSBjYXNlc1tpXS5jaGlsZHJlblswXTtcclxuICAgICAgICB0ZXh0X2FmdGVyW2ldID0gY2FzZXNbaV0uY2hpbGRyZW5bMV07XHJcbiAgICAgICAgdGV4dF9leHBlY3RlZFtpXSA9IGNhc2VzW2ldLmNoaWxkcmVuWzJdO1xyXG4gICAgICAgIG1hdGNoZXNbaV0gPSBjYXNlc1tpXS5jaGlsZHJlblszXTtcclxuICAgIH1cclxufVxyXG5cclxuZnVuY3Rpb24gYWRkX3JlcGxhY2VtZW50X2ZpZWxkKCl7XHJcbiAgICB2YXIgZGl2ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImRpdlwiKTtcclxuICAgIGRpdi5jbGFzc05hbWUgPSBcIm15LWNhc2UtYmxvY2tcIjtcclxuICAgIGRpdi5pbm5lckhUTUwgPSBcIjx0ZXh0YXJlYSBjbGFzcz1cXFwidGV4dF9iZWZvcmVcXFwiIHBsYWNlaG9sZGVyPVxcXCJvcmlnaW5hbCB0ZXh0XFxcIj48L3RleHRhcmVhPjx0ZXh0YXJlYSBjbGFzcz1cXFwidGV4dF9hZnRlclxcXCIgcGxhY2Vob2xkZXI9XFxcInJlc3VsdCBvZiByZXBsYWNlbWVudFxcXCIgZGlzYWJsZWQ+PC90ZXh0YXJlYT48dGV4dGFyZWEgY2xhc3M9XFxcInRleHRfZXhwZWN0ZWRcXFwiIHBsYWNlaG9sZGVyPVxcXCJleHBlY3RlZCByZXN1bHRcXFwiPjwvdGV4dGFyZWE+PGRpdiBjbGFzcz1cXFwiYW5zd2VyIG5vLW1hdGNoIGluY3JlYXNlXFxcIj4mI3hmMDBkPC9kaXY+IDxpbnB1dCB0eXBlPVxcXCJidXR0b25cXFwiIHZhbHVlPVxcXCImI3hmMDY4XFxcIiBpZD1cXFwicmVtb3ZlXFxcIiBvbmNsaWNrPVxcXCJyZXR1cm4gcmVtb3ZlX3JlcGxhY2VtZW50X2ZpZWxkKHRoaXMpXFxcIj5cIjtcclxuICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwiYmxvY2stY2FzZXNcIikuYXBwZW5kQ2hpbGQoZGl2KTtcclxuICAgIHJlYWRfY2FzZXNfcmVwbGFjZW1lbnQoKTtcclxuICAgIGFkZEV2ZW50cygpO1xyXG4gICAgZGl2LmNsYXNzTGlzdC5hZGQoXCJhZGQtY2FzZS1ibG9ja1wiKTtcclxuICAgIHJldHVybiBmYWxzZTtcclxufVxyXG5cclxuZnVuY3Rpb24gcmVtb3ZlX3JlcGxhY2VtZW50X2ZpZWxkKGZpZWxkKXtcclxuICAgIHZhciBjb250RGl2ID0gZmllbGQucGFyZW50Tm9kZTtcclxuICAgIHZhciBuZXh0ID0gY29udERpdi5uZXh0RWxlbWVudFNpYmxpbmc7XHJcbiAgICB2YXIgZmlyc3QgPSBuZXh0O1xyXG5cclxuICAgIGNvbnREaXYuY2xhc3NMaXN0LnJlbW92ZShcImFkZC1jYXNlLWJsb2NrXCIpO1xyXG4gICAgY29udERpdi5jbGFzc0xpc3QuYWRkKFwicmVtb3ZlLWNhc2UtYmxvY2tcIik7XHJcbiAgICBjb250RGl2LmFkZEV2ZW50TGlzdGVuZXIoXCJ3ZWJraXRBbmltYXRpb25FbmRcIiwgZnVuY3Rpb24oKSB7ICAgIFxyXG4gICAgICAgICAgICBjb250RGl2LnBhcmVudE5vZGUucmVtb3ZlQ2hpbGQoY29udERpdik7IFxyXG4gICAgICAgICAgICByZWFkX2Nhc2VzX3JlcGxhY2VtZW50KCk7XHJcbiAgICAgICAgICAgIGFkZEV2ZW50cygpO1xyXG4gICAgICAgIH1cclxuICAgICk7IFxyXG5cclxuICAgIHdoaWxlKG5leHQgIT0gbnVsbCl7ICAgIFxyXG4gICAgICAgIG5leHQuY2xhc3NMaXN0LmFkZChcIm1vdmUtdXAtY2FzZVwiKTtcclxuICAgICAgICBuZXh0ID0gbmV4dC5uZXh0RWxlbWVudFNpYmxpbmc7XHJcbiAgICB9XHJcblxyXG4gICAgc2V0VGltZW91dChkZWxldGVNb3ZlVXBBbmltYXRpb24sIDEwMDAsIGZpcnN0KTtcclxuXHJcbiAgICByZXR1cm4gZmFsc2U7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIGRlbGV0ZU1vdmVVcEFuaW1hdGlvbihmaXJzdCl7XHJcbiAgICB2YXIgbmV4dCA9IGZpcnN0O1xyXG4gICAgd2hpbGUobmV4dCAhPSBudWxsKXtcclxuICAgICAgICBjb25zb2xlLmxvZyhuZXh0KTtcclxuICAgICAgICBuZXh0LmNsYXNzTGlzdC5yZW1vdmUoXCJtb3ZlLXVwLWNhc2VcIik7IFxyXG4gICAgICAgIG5leHQuY2xhc3NMaXN0LnJlbW92ZShcImFkZC1jYXNlLWJsb2NrXCIpO1xyXG4gICAgICAgIG5leHQgPSBuZXh0Lm5leHRFbGVtZW50U2libGluZztcclxuICAgIH0gXHJcbn1cclxuXHJcbmZ1bmN0aW9uIGZpbGxSZXBsYWNlRXhhbXBsZShpbnB1dCl7XHJcbiAgICByZWdleC52YWx1ZSA9IGlucHV0LnJlZ2V4O1xyXG4gICAgcmVwbGFjZW1lbnQudmFsdWUgPSBpbnB1dC5yZXBsYWNlO1xyXG4gICAgZm9yKHZhciBpID0gMDsgaSA8IGlucHV0LnZhbHVlcy5sZW5ndGg7IGkrKyl7XHJcbiAgICAgICAgdGV4dF9iZWZvcmVbaV0udmFsdWUgPSBpbnB1dC52YWx1ZXNbaV0udmFsdWU7XHJcbiAgICAgICAgdGV4dF9leHBlY3RlZFtpXS52YWx1ZSA9IGlucHV0LnZhbHVlc1tpXS5hbnN3ZXI7XHJcbiAgICB9XHJcbiAgICByZWFkX2Nhc2VzX3JlcGxhY2VtZW50KCk7XHJcbiAgICBnZXRSZXN1bHRPZlJlcGxhY2VtZW50Rm9yQWxsKCk7XHJcbiAgICBjb25zb2xlLmxvZyhpbnB1dCk7XHJcbn0iLCJkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKFwiRE9NQ29udGVudExvYWRlZFwiLCBmdW5jdGlvbiAoKSB7XHJcbiAgICBnZXRQYWdlKFwibWVudVwiKTtcclxuICAgIGdldFBhZ2UoXCJjb21wYXJlXCIpO1xyXG59KTtcclxuXHJcbndpbmRvdy5vbnBvcHN0YXRlID0gZnVuY3Rpb24gKCkge1xyXG4gICAgZ2V0UGFnZShkb2N1bWVudC5sb2NhdGlvbi5oYXNoLnJlcGxhY2UoXCIjXCIsIFwiXCIpKTtcclxufVxyXG5cclxuZnVuY3Rpb24gZ2V0UGFnZShwYWdlLCBleGFtcGxlKSB7XHJcbiAgICBsZXQgeGhyID0gbmV3IFhNTEh0dHBSZXF1ZXN0KCk7XHJcbiAgICB4aHIub3BlbihcIkdFVFwiLCBcIi9cIiArIHBhZ2UgKyBcIi5odG1sXCIsIHRydWUpO1xyXG4gICAgeGhyLnNldFJlcXVlc3RIZWFkZXIoXCJYLVJlcXVlc3RlZC1XaXRoXCIsIFwiWE1MSHR0cFJlcXVlc3RcIik7XHJcbiAgICB4aHIuc2VuZCgpO1xyXG5cclxuICAgIHhoci5vbnJlYWR5c3RhdGVjaGFuZ2UgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgaWYgKHhoci5yZWFkeVN0YXRlICE9IDQpIHJldHVybjtcclxuICAgICAgICBpZiAoeGhyLnN0YXR1cyAhPSAyMDApIHtcclxuICAgICAgICAgICAgYWxlcnQoeGhyLnN0YXR1cyArIFwiOiBcIiArIHhoci5zdGF0dXNUZXh0KTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICBpZiAocGFnZSA9PSBcIm1lbnVcIikge1xyXG4gICAgICAgICAgICAgICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5tZW51XCIpLmlubmVySFRNTCA9IHhoci5yZXNwb25zZVRleHQ7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLmZsZXgtY29udGFpbmVyXCIpLmlubmVySFRNTCA9IHhoci5yZXNwb25zZVRleHQ7XHJcbiAgICAgICAgICAgICAgICBpZiAocGFnZSA9PSBcImNvbXBhcmVcIikge1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbXBhcmlzb24oKTtcclxuICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAocGFnZSA9PSBcInJlcGxhY2VcIikge1xyXG4gICAgICAgICAgICAgICAgICAgIHJlcGxhY2UoKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGlmKGV4YW1wbGUgIT0gbnVsbCl7XHJcbiAgICAgICAgICAgICAgICAgICAgZ2V0VGFza3MoZXhhbXBsZSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9XHJcbn1cclxuXHJcblxyXG5mdW5jdGlvbiBnZXRUYXNrcyAocGFnZSkge1xyXG4gICAgbGV0IHhociA9IG5ldyBYTUxIdHRwUmVxdWVzdCgpO1xyXG4gICAgeGhyLm9wZW4oXCJHRVRcIiwgXCIuLi90YXNrcy9cIiArIHBhZ2UgKyBcIlRhc2tzLmpzb25cIiwgdHJ1ZSk7XHJcbiAgICB4aHIuc2V0UmVxdWVzdEhlYWRlcihcIlgtUmVxdWVzdGVkLVdpdGhcIiwgXCJYTUxIdHRwUmVxdWVzdFwiKTtcclxuICAgIHhoci5zZW5kKCk7XHJcblxyXG4gICAgeGhyLm9ucmVhZHlzdGF0ZWNoYW5nZSA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICBpZiAoeGhyLnJlYWR5U3RhdGUgIT0gNCkgcmV0dXJuO1xyXG4gICAgICAgIGlmICh4aHIuc3RhdHVzICE9IDIwMCkge1xyXG4gICAgICAgICAgICBhbGVydCh4aHIuc3RhdHVzICsgXCI6IFwiICsgeGhyLnN0YXR1c1RleHQpO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIHZhciBvYmogPSBKU09OLnBhcnNlKHhoci5yZXNwb25zZVRleHQpO1xyXG4gICAgICAgICAgICBpZiAocGFnZSA9PSBcImNvbXBhcmUxXCIgfHwgcGFnZSA9PSBcImNvbXBhcmUyXCIpIHtcclxuICAgICAgICAgICAgICAgIGZpbGxDb21wYXJlRXhhbXBsZShvYmopO1xyXG4gICAgICAgICAgICB9IGVsc2UgaWYgKHBhZ2UgPT0gXCJyZXBsYWNlMVwiIHx8IHBhZ2UgPT0gXCJyZXBsYWNlMlwiKSB7XHJcbiAgICAgICAgICAgICAgICBmaWxsUmVwbGFjZUV4YW1wbGUob2JqKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH1cclxufVxyXG5cclxuIl19
